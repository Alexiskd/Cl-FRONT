import{b as r,j as e,q as E,y as g,x as T,p as o,G as m,z as A,E as W,F as B,Y as O,A as R}from"./index-6iWKD2A3.js";import{D as K,a as q}from"./DialogContent-BnRQpyZi.js";import{D as G,a as U}from"./DialogTitle-DZ4LGPUH.js";const b=n=>n.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,""),V=()=>{const[n,i]=r.useState(""),[l,y]=r.useState([]),[C,c]=r.useState(!0),[d,x]=r.useState(null),[j,S]=r.useState(!1),[k,N]=r.useState(""),[v,L]=r.useState("success"),[w,h]=r.useState(!1);r.useEffect(()=>{(async()=>{try{c(!0),x(null);const t=await fetch("https://cl-back.onrender.com/produit/cles/all?limit=1000&skip=0",{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok){const z=await t.json();throw new Error(z.message||"Erreur lors de la récupération des clés.")}const M=await t.json();y(M)}catch(t){x(t.message)}finally{c(!1)}})()},[]);const D=r.useCallback(a=>{i(a.target.value)},[]),u=r.useMemo(()=>{if(n.length<3)return[];const a=b(n);return l.filter(t=>b(t.nom).includes(a))},[l,n]),p=r.useCallback((a,t)=>{t!=="clickaway"&&S(!1)},[]),F=()=>{h(!0)},f=()=>{h(!1),i("")},s={page:{backgroundColor:"#f5f5f5",padding:"16px",textAlign:"center",maxWidth:"800px",margin:"20px auto",borderRadius:"12px"},bigButton:{fontSize:"1.5rem",padding:"16px 32px",backgroundColor:"#2E7D32",borderRadius:"12px",textTransform:"none",boxShadow:"none","&:hover":{backgroundColor:"#276324",boxShadow:"none"}},card:{backgroundColor:"#fff",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",transition:"transform 0.3s ease, box-shadow 0.3s ease","&:hover":{transform:"translateY(-4px)",boxShadow:"0 6px 12px rgba(0,0,0,0.15)"},display:"flex",flexDirection:"column",overflow:"hidden"},cardMedia:{height:180,width:"100%",objectFit:"contain",padding:"16px",backgroundColor:"#fff"},cardContent:{flexGrow:1,padding:"16px",fontFamily:"Montserrat, sans-serif",textAlign:"center"},productName:{fontSize:"1.1rem",fontWeight:600,marginBottom:"8px",color:"#333"},dialogContent:{padding:"24px"},textField:{marginBottom:"24px"}};return e.jsxs(E,{sx:s.page,children:[e.jsx(g,{variant:"contained",size:"large",onClick:F,sx:s.bigButton,children:"Rechercher votre Clé"}),e.jsxs(K,{open:w,onClose:f,fullWidth:!0,maxWidth:"md",children:[e.jsx(G,{sx:{fontFamily:"Montserrat, sans-serif",fontWeight:600},children:"Recherche votre Clé"}),e.jsxs(q,{dividers:!0,sx:s.dialogContent,children:[e.jsx(T,{label:"Tapez la réference marqué sur votre clé (min. 3 caractères)",variant:"outlined",fullWidth:!0,value:n,onChange:D,sx:s.textField}),C?e.jsx(o,{sx:{fontFamily:"Montserrat, sans-serif"},children:"Chargement..."}):d?e.jsx(o,{color:"error",sx:{fontFamily:"Montserrat, sans-serif"},children:d}):n.length<3?e.jsx(o,{sx:{fontFamily:"Montserrat, sans-serif"},children:"Veuillez taper au moins 3 caractères pour lancer la recherche."}):u.length>0?e.jsx(m,{container:!0,spacing:3,children:u.map((a,t)=>e.jsx(m,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(A,{sx:s.card,children:[e.jsx(W,{component:"img",image:a.imageUrl?a.imageUrl.startsWith("http")?a.imageUrl:`https://cl-back.onrender.com/${a.imageUrl}`:"",alt:a.nom,sx:s.cardMedia,loading:"lazy"}),e.jsxs(B,{sx:s.cardContent,children:[e.jsx(o,{sx:s.productName,children:a.nom}),e.jsxs(o,{variant:"body2",children:["Marque : ",a.marque]}),e.jsxs(o,{variant:"body2",children:["Prix : ",a.prix," €"]})]})]})},t))}):e.jsx(o,{sx:{fontFamily:"Montserrat, sans-serif"},children:"Aucun résultat trouvé."})]}),e.jsx(U,{children:e.jsx(g,{onClick:f,sx:{color:"#2E7D32",fontFamily:"Montserrat, sans-serif",fontWeight:600},children:"Fermer"})})]}),e.jsx(O,{open:j,autoHideDuration:6e3,onClose:p,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(R,{onClose:p,severity:v,sx:{width:"100%",fontFamily:"Montserrat, sans-serif"},children:k})})]})};export{V as default};
